from app.serializers.userSerializers import embeddedUserResponse


def reportEntity(report) -> dict:
    return {
        "id": str(report["_id"]),
        "application_name": report["application_name"],
        "html_content": report["html_content"],
        "vulnerabilities": report["vulnerabilities"],
        "summary": report["summary"],
        "user": str(report["user"]),
        "created_at": report["created_at"],
        "updated_at": report["updated_at"]
    }


def populatedReportEntity(report) -> dict:
    return {
        "id": str(report["_id"]),
        "application_name": report["application_name"],
        "html_content": report["html_content"],
        "vulnerabilities": report["vulnerabilities"],
        "summary": report["summary"],
        "user": embeddedUserResponse(report["user"]),
        "created_at": report["created_at"],
        "updated_at": report["updated_at"]
    }


def reportListEntity(reports) -> list:
    return [populatedReportEntity(report) for report in reports]
